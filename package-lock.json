import Realm from 'realm';
import {User, Task} from './UserModel';

const realmConfig = {
  schema: [User, Task],
};
const realm = new Realm(realmConfig);


export function createUserRecord(id, name) {

  const users = realm.objects('User').sorted('id', true);
  const newId = users.length > 0 ? users[0].id + 1 : 1;

  const tasks = [
    { id: 1, description: 'Task 1' },
    { id: 2, description: 'Task 2' },
  ]

  realm.write(() => {
    realm.create('User', { id: newId, name, tasks});
  });
}

export function deleteUserRecord(id) {

  function convertNumberStringToNumber(numberString) {
    switch (numberString) {
      case 'один':
        return 0;
      case 'два':
        return 1;
      case 'три':
        return 2;
      case 'четыре':
        return 3;
      case 'пять':
        return 4;
      case 'шесть':
        return 5;
      case 'семь':
        return 6;
      case 'восемь':
        return 7;
      case 'девять':
        return 8;
      default:
        return +numberString-1; // Return NaN for unrecognized number strings
    }
  }


  const users = realm.objects('User');
  const user = users[convertNumberStringToNumber(id)]
  if (user) {
    realm.write(() => {
      realm.delete(user);
    });
    console.log(`User with ID ${id} deleted successfully.`);
  } else {
    console.log(`User with ID ${id} not found.`);
  }
}

export function updateUserRecord(id,newName) {

  console.log(typeof id);
  console.log(id);
  console.log(typeof newName);
  console.log(newName);


  const users = realm.objects('User');
  const user = users[id]
  console.log(user);
  if (user) {
    realm.write(() => {
      user.name = newName;
    });
    console.log(`User with ID ${id} updated successfully.`);
  } else {
    console.log(`User with ID ${id} not found.`);
  }
}

export function getAllUsers() {

  return realm.objects('User');
}

export function deleteAllUsers() {
  realm.write(() => {
    const allUsers = realm.objects('User');
    realm.delete(allUsers)
  });
}
